<!DOCTYPE html>
<html>
<head>
	<title></title>
</head>
<body>
<script type="text/javascript">
	/*
	promise.all([p1,p2,p3])

	1.all接受一个数组
	2.数组保存的是promise对象，也可能是非数组对象
	3.all必须所有的promise对象是resolve状态才表示成功
	*/
	let p1 = Promise.resolve(1);
	let p2 = 2;
	let p3 = Promise.resolve(3);
	let p4 = Promise.reject("error4");


	Promise.all2=function(arr){
		return new Promise((resolve,reject)=>{
			let result = [];
			let count = 0;
			if(arr.length===0)
				return new Promise.resolve([]);
			for(let i=0;i<arr.length;i++){
				/*
				arr[i]保存的是promise对象
				1.由于arr[i]可能是非promise对象，因此我们需要对每个参数进行封装。
				*/
				Promise.resolve(arr[i]).then((data)=>{
					result.push(data);
					count++;
					if(count===arr.length)
						resolve(result);//成功返回
				}).catch((msg)=>{
					reject("error");
				})
			}
		})
	}

	//测试
	Promise.all2([p1,p2,p3]).then((data)=>{
		console.log(data);
	}).catch((msg)=>{
		console.log(msg);
	})
</script>
</body>
</html>